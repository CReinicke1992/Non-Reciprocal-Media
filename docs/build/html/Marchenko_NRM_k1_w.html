
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Marchenko_NRM_k1_w module &#8212; Non-reciprocal wavefields (1.5 D) 28-03-2018 documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Wavefield_NRM_k1_w module" href="Wavefield_NRM_k1_w.html" />
    <link rel="prev" title="Layered_NRM_k1_w module" href="Layered_NRM_k1_w.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Wavefield_NRM_k1_w.html" title="Wavefield_NRM_k1_w module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Layered_NRM_k1_w.html" title="Layered_NRM_k1_w module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Non-reciprocal wavefields (1.5 D) 28-03-2018 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" accesskey="U">k1-w-domain</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="Layered_NRM_k1_w.html"
                        title="previous chapter">Layered_NRM_k1_w module</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="Wavefield_NRM_k1_w.html"
                        title="next chapter">Wavefield_NRM_k1_w module</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/Marchenko_NRM_k1_w.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-Marchenko_NRM_k1_w">
<span id="marchenko-nrm-k1-w-module"></span><h1>Marchenko_NRM_k1_w module<a class="headerlink" href="#module-Marchenko_NRM_k1_w" title="Permalink to this headline">¶</a></h1>
<p>Routines for applying the Marchenko method in 1.5D non-reciprocal media.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Authors:</th><td class="field-body">Christian Reinicke (<a class="reference external" href="mailto:c&#46;reinicke&#37;&#52;&#48;tudelft&#46;nl">c<span>&#46;</span>reinicke<span>&#64;</span>tudelft<span>&#46;</span>nl</a>), Kees Wapenaar (), and Evert Slob ()</td>
</tr>
<tr class="field-even field"><th class="field-name">Copyright:</th><td class="field-body">Christian Reinicke (<a class="reference external" href="mailto:c&#46;reinicke&#37;&#52;&#48;tudelft&#46;nl">c<span>&#46;</span>reinicke<span>&#64;</span>tudelft<span>&#46;</span>nl</a>), Kees Wapenaar (), and Evert Slob ()</td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="Marchenko_NRM_k1_w.Marchenko_NRM_k1_w">
<em class="property">class </em><code class="descclassname">Marchenko_NRM_k1_w.</code><code class="descname">Marchenko_NRM_k1_w</code><span class="sig-paren">(</span><em>nt</em>, <em>dt</em>, <em>nr</em>, <em>dx1</em>, <em>verbose=False</em>, <em>eps=None</em>, <em>x3vec=array([0.])</em>, <em>avec=array([0.])</em>, <em>b11vec=array([0.])</em>, <em>b13vec=array([0.])</em>, <em>b33vec=array([0.])</em>, <em>g1vec=array([0.])</em>, <em>g3vec=array([0.])</em>, <em>ReciprocalMedium=False</em>, <em>AdjointMedium=False</em>, <em>x3F=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Marchenko_NRM_k1_w.html#Marchenko_NRM_k1_w"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Marchenko_NRM_k1_w.Marchenko_NRM_k1_w" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="Layered_NRM_k1_w.html#Layered_NRM_k1_w.Layered_NRM_k1_w" title="Layered_NRM_k1_w.Layered_NRM_k1_w"><code class="xref py py-class docutils literal notranslate"><span class="pre">Layered_NRM_k1_w.Layered_NRM_k1_w</span></code></a></p>
<p>is a class to apply the Marchenko method to wavefields in 1.5D (non-)
reciprocal media.</p>
<p>The class Marchenko_NRM_k1_w operates on scalar wavefields in 1.5D (non-)
reciprocal media, ideally defined by the class Layered_NRM_k1_w. We 
consider all horizontal-wavenumbers and all frequencies, that are sampled 
by the given number of samples and by the given sample intervals, in space 
(‘nr’, ‘dx1’) as well as in time (‘nt’, ‘dt’). Note that the separation of 
focusing and Green’s functions requires a transformation to the space-time
domain. The forward- and backward-transformations between domains introduce
small artefacts due to finite sampling. Thus, the focusing 
functions cannot be retrieved within double-precision.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>nt</strong> : int</p>
<blockquote>
<div><p>Number of time samples.</p>
</div></blockquote>
<p><strong>dt</strong> : int, float</p>
<blockquote>
<div><p>Time sample interval in seconds.</p>
</div></blockquote>
<p><strong>nr</strong> : int</p>
<blockquote>
<div><p>Number of space samples.</p>
</div></blockquote>
<p><strong>dx1</strong> : int, float</p>
<blockquote>
<div><p>Space sample interval in metres.</p>
</div></blockquote>
<p><strong>verbose</strong> : bool, optional</p>
<blockquote>
<div><p>Set ‘verbose=True’ to receive feedback in the command line.</p>
</div></blockquote>
<p><strong>eps</strong> : int, float, optional</p>
<blockquote>
<div><p>A real-valued scalar can be assigned to ‘eps’ to reduce the wrap-around 
effect of wavefields in the time domain. If the inverse Fourier 
transform is defined as,</p>
<blockquote>
<div><p><span class="math notranslate">\(f(t)  = \int F(\omega) \; \mathrm{e}^{\mathrm{j} \omega t} 
\mathrm{d}\omega\)</span>,</p>
</div></blockquote>
<p>which is ensured if the function <strong>K1W2X1T</strong> is used, ‘eps’ 
(<span class="math notranslate">\(=\epsilon\)</span>) should be positive to the suppress wrap-around 
effect from positive to negative time,</p>
<blockquote>
<div><p><span class="math notranslate">\(f(t) \mathrm{e}^{- \epsilon t} = 
\int F(\omega + \mathrm{j} \epsilon) \; 
\mathrm{e}^{\mathrm{j} (\omega + \mathrm{j} \epsilon) t} 
\mathrm{d}\omega\)</span>.</p>
</div></blockquote>
<p>Recommended value eps = <span class="math notranslate">\(\frac{3}{n_f dt}\)</span>.</p>
</div></blockquote>
<p><strong>x3vec</strong> : numpy.ndarray</p>
<blockquote>
<div><p>Vertical spatial vector <span class="math notranslate">\(x_3\)</span>, for n layers ‘x3vec’ must have the 
shape (n,). We define the <span class="math notranslate">\(x_3\)</span>-axis as downward-pointing. 
Implicitly, the first value on the <span class="math notranslate">\(x_3\)</span>-axis is zero (not stored 
in ‘x3vec’).</p>
</div></blockquote>
<p><strong>avec</strong> : numpy.ndarray</p>
<blockquote>
<div><p>Medium parameter <span class="math notranslate">\(\alpha\)</span> (real-valued), for n layers ‘avec’ 
must have the shape (n,).</p>
</div></blockquote>
<p><strong>b11vec</strong> : numpy.ndarray</p>
<blockquote>
<div><p>Medium parameter <span class="math notranslate">\(\beta_{11}\)</span> (real-valued), for n layers 
‘b11vec’ must have the shape (n,).</p>
</div></blockquote>
<p><strong>b13vec</strong> : numpy.ndarray, optional</p>
<blockquote>
<div><p>Medium parameter <span class="math notranslate">\(\beta_{13}\)</span> (real-valued), for n layers 
‘b13vec’ must have the shape (n,).</p>
</div></blockquote>
<p><strong>b33vec</strong> : numpy.ndarray</p>
<blockquote>
<div><p>Medium parameter <span class="math notranslate">\(\beta_{33}\)</span> (real-valued), for n layers 
‘b33vec’ must have the shape (n,).</p>
</div></blockquote>
<p><strong>g1vec</strong> : numpy.ndarray, optional</p>
<blockquote>
<div><p>Medium parameter <span class="math notranslate">\(\gamma_1\)</span> (real-valued for non-reciprocal 
media), for n layers ‘g1vec’ must have the shape (n,).</p>
</div></blockquote>
<p><strong>g3vec</strong> : numpy.ndarray, optional</p>
<blockquote>
<div><p>Medium parameter <span class="math notranslate">\(\gamma_3\)</span> (real-valued for non-reciprocal 
media), for n layers ‘g3vec’ must have the shape (n,).</p>
</div></blockquote>
<p><strong>ReciprocalMedium</strong> : bool, optional</p>
<blockquote>
<div><p>For non-reciprocal media set ‘ReciprocalMedium=False’, for reciprocal 
media set ‘ReciprocalMedium=True’.</p>
</div></blockquote>
<p><strong>AdjointMedium</strong> : bool, optional</p>
<blockquote>
<div><p>Set ‘AdjointMedium=True’ to compute scattering coefficients and 
propagators in an adjoint medium <span class="math notranslate">\(^{(a)}\)</span>. We have defined the 
scattering and propagation in the adjoint medium only for 
flux-normalisation.</p>
</div></blockquote>
<p><strong>x3F</strong> : int, float, optional</p>
<blockquote>
<div><p>Focusing depth.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">class</p>
<blockquote class="last">
<div><p>A class to apply the Marchenko method to a scalar wavefield in  a 1.5D 
non-reciprocal medium. The following instances are 
defined:</p>
<blockquote>
<div><ul class="simple">
<li><strong>x3vec</strong>: <span class="math notranslate">\(x_3\)</span>.</li>
<li><strong>avec</strong>: <span class="math notranslate">\(\alpha\)</span>.</li>
<li><strong>b11vec</strong>: <span class="math notranslate">\(\beta_{11}\)</span>.</li>
<li><strong>b13vec</strong>: <span class="math notranslate">\(\beta_{13}\)</span>.</li>
<li><strong>b33vec</strong>: <span class="math notranslate">\(\beta_{33}\)</span>.</li>
<li><strong>g1vec</strong>: <span class="math notranslate">\(\gamma_1\)</span>.</li>
<li><strong>g3vec</strong>: <span class="math notranslate">\(\gamma_3\)</span>.</li>
<li><strong>ReciprocalMedium</strong>: True for reciprocal media, False for non-reciprocal media.</li>
<li><strong>AdjointMedium</strong>: If True, propagation and scattering are defined in a medium and in its adjoint.</li>
<li><strong>k3</strong>: Vertical-wavenumber for positive ‘k1’.</li>
<li><strong>k3n</strong>: Vertical-wavenumber for negative ‘k1’.</li>
<li><strong>x3F</strong>: Focusing depth.</li>
</ul>
</div></blockquote>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Kees document as soon as it is published.</p>
<dl class="method">
<dt id="Marchenko_NRM_k1_w.Marchenko_NRM_k1_w.TruncateMedium">
<code class="descname">TruncateMedium</code><span class="sig-paren">(</span><em>x3F</em>, <em>UpdateSelf=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Marchenko_NRM_k1_w.html#Marchenko_NRM_k1_w.TruncateMedium"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Marchenko_NRM_k1_w.Marchenko_NRM_k1_w.TruncateMedium" title="Permalink to this definition">¶</a></dt>
<dd><p>truncates the medium below the focusing depth <span class="math notranslate">\(x_{3,f}\)</span> 
(‘x3F’).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x3F</strong> : int, float</p>
<blockquote>
<div><p>Focusing depth.</p>
</div></blockquote>
<p><strong>UpdateSelf</strong> : bool, optional</p>
<blockquote>
<div><p>If ‘UpdateSelf=True’ the focusing depth level is not only inserted 
in the truncated medium but also in the ‘self’ parameters of the
actual medium.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dict</p>
<blockquote class="last">
<div><p>Dictionary that contains the parameters of the truncated medium</p>
<blockquote>
<div><ul class="simple">
<li><strong>x3vec</strong>:  Depth vector.</li>
<li><strong>avec</strong>:   <span class="math notranslate">\(\alpha\)</span> vector.</li>
<li><strong>b11vec</strong>: <span class="math notranslate">\(\beta_{11}\)</span> vector.</li>
<li><strong>b13vec</strong>: <span class="math notranslate">\(\beta_{11}\)</span> vector.</li>
<li><strong>b33vec</strong>: <span class="math notranslate">\(\beta_{11}\)</span> vector.</li>
<li><strong>g1vec</strong>:  <span class="math notranslate">\(\gamma_1\)</span> vector.</li>
<li><strong>g3vec</strong>:  <span class="math notranslate">\(\gamma_3\)</span> vector.</li>
<li><strong>K3</strong>:     <span class="math notranslate">\(k_3(k_1)\)</span> vector.</li>
<li><strong>K3n</strong>:    <span class="math notranslate">\(k_3(-k_1)\)</span> vector.</li>
<li><strong>LP</strong>:     Eigenvalues <span class="math notranslate">\(\lambda^+(k_1)\)</span>.</li>
<li><strong>LPn</strong>:    Eigenvalues <span class="math notranslate">\(\lambda^+(-k_1)\)</span>.</li>
<li><strong>LM</strong>:     Eigenvalues <span class="math notranslate">\(\lambda^-(k_1)\)</span>.</li>
<li><strong>LMn</strong>:    Eigenvalues <span class="math notranslate">\(\lambda^-(-k_1)\)</span>.</li>
</ul>
</div></blockquote>
<p>All medium parameter vectors are stored in arrays of shape (n,).
The vertical wavenumbers and the eigenvalues are stored in arrays 
of shape (nf,nr,n).</p>
<p>If the eigenvalues were not computed previously the parameters ‘LP’, 
‘LM’, ‘LPn’ and ‘LMn’ will be of the type None.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Kees document as soon as it is published.</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Marchenko_NRM_k1_w</span> <span class="k">import</span> <span class="n">Marchenko_NRM_k1_w</span> <span class="k">as</span> <span class="n">Marchenko</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Initialise wavefield</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">LM</span><span class="p">(</span><span class="n">nt</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span><span class="n">dt</span><span class="o">=</span><span class="mf">5e-3</span><span class="p">,</span><span class="n">nr</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span><span class="n">dx1</span><span class="o">=</span><span class="mf">12.5</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="n">x3vec</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">2.2</span><span class="p">,</span><span class="mf">3.7</span><span class="p">])</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span><span class="n">eps</span><span class="o">=</span><span class="mi">3</span><span class="o">/</span><span class="p">(</span><span class="mi">513</span><span class="o">*</span><span class="mf">5e-3</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="n">avec</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="n">b11vec</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.4</span><span class="p">,</span><span class="mf">3.14</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="mf">1e-4</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="n">b13vec</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">2.4</span><span class="p">,</span><span class="mf">1.2</span><span class="p">])</span><span class="o">*</span><span class="mf">1e-4</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="n">b33vec</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.4</span><span class="p">,</span><span class="mf">3.14</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="mf">1e-4</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="n">g1vec</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">1.3</span><span class="p">])</span><span class="o">*</span><span class="mf">1e-4</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="n">g3vec</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.8</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">2.3</span><span class="p">])</span><span class="o">*</span><span class="mf">1e-4</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="n">ReciprocalMedium</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">AdjointMedium</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">x3vec</span>
<span class="go">array([1100., 2200., 3700.])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">avec</span>
<span class="go">array([0.001, 0.002, 0.003])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Truncate medium for focusing at x3F = 1500</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Trunc</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">TruncateMedium</span><span class="p">(</span><span class="n">x3F</span><span class="o">=</span><span class="mi">1500</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Trunc</span><span class="p">[</span><span class="s1">&#39;x3vec&#39;</span><span class="p">]</span>
<span class="go">array([1100., 1500., 2200.])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Trunc</span><span class="p">[</span><span class="s1">&#39;avec&#39;</span><span class="p">]</span>
<span class="go">array([0.001, 0.002, 0.002])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Marchenko_NRM_k1_w.Marchenko_NRM_k1_w.Projector_x1_t">
<code class="descname">Projector_x1_t</code><span class="sig-paren">(</span><em>x3F</em>, <em>f0=None</em>, <em>delta=0</em>, <em>RelativeTaperLength=0.015625</em>, <em>UpdateSelf=False</em>, <em>normalisation='flux'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Marchenko_NRM_k1_w.html#Marchenko_NRM_k1_w.Projector_x1_t"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Marchenko_NRM_k1_w.Marchenko_NRM_k1_w.Projector_x1_t" title="Permalink to this definition">¶</a></dt>
<dd><p>computes a projector that separates the focusing and Green’s 
functions in the space-time domain.</p>
<p>The projector mutes all arrival before the direct transmission 
<span class="math notranslate">\(T_d^+(x_{3,f},x_{3,0},t)\)</span> associated with sources at the 
surface <span class="math notranslate">\(x_{3,0}\)</span> and a receiver at the focusing point 
<span class="math notranslate">\(x_{3,f}\)</span>. The direct transmission itself is also muted.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x3F</strong> : int, float</p>
<blockquote>
<div><p>Focusing depth.</p>
</div></blockquote>
<p><strong>f0</strong> : int, float</p>
<blockquote>
<div><p>Central frequency of a Ricker wavelet in Hz to compute the width of
the taper of the projector according to,
<span class="math notranslate">\(\frac{\sqrt{6}}{\pi f_0}\)</span>,
(trough-to-trough time).</p>
</div></blockquote>
<p><strong>delta</strong> : int, float</p>
<blockquote>
<div><p>The width of the wavelet in seconds that the projector should take
into account. If the input parameter ‘f0’ is defined the parameter 
‘delta’ is ignored.</p>
</div></blockquote>
<p><strong>RelativeTaperLength</strong> : int, float, optional</p>
<blockquote>
<div><p>The product of ‘RelativeTaperLength’ and the number of temporal 
samples ‘nt’ determines the taper length. The default value is 
‘RelativeTaperLength’<span class="math notranslate">\(=2^{-5}\)</span>.</p>
</div></blockquote>
<p><strong>UpdateSelf</strong> : bool, optional</p>
<blockquote>
<div><p>If ‘UpdateSelf=True’ the focusing depth level ‘x3F’ and the 
projector ‘P’ are saved as ‘self’ parameters. In addition, the 
focusing depth level is inserted in the model.</p>
</div></blockquote>
<p><strong>normalisation</strong> : str, optional</p>
<blockquote>
<div><p>For pressure-normalisation set normalisation=’pressure’, for 
flux-normalisation set normalisation=’flux’.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dict</p>
<blockquote class="last">
<div><p>Dictionary that contains</p>
<blockquote>
<div><ul class="simple">
<li><strong>P</strong>:    The projector.</li>
<li><strong>td</strong>:   The direct transmission.</li>
</ul>
</div></blockquote>
<p>The outputs are in the space-time domain. They are stored in arrays 
of shape (nt,nr).</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Wavefield_NRM_k1_w.html" title="Wavefield_NRM_k1_w module"
             >next</a> |</li>
        <li class="right" >
          <a href="Layered_NRM_k1_w.html" title="Layered_NRM_k1_w module"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Non-reciprocal wavefields (1.5 D) 28-03-2018 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" >k1-w-domain</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Christian Reinicke, Kees Wapenaar, and Evert Slob.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.2.
    </div>
  </body>
</html>